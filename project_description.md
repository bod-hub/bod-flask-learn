# Описание проекта FlaskLearn

## Общее описание
FlaskLearn — это full-stack веб-приложение для обучения основам фреймворка Flask. 
Приложение представляет собой платформу с уроками, разбитыми на разделы. Уроки содержат теоретический материал, тесты и задачи. 
Контент управляется администратором через специальную панель.

## Стек технологий
*   **Backend**: Python, Flask, Gunicorn (для продакшена).
*   **Database**: PostgreSQL (Supabase).
*   **Storage**: Supabase Storage (для хранения изображений).
*   **Frontend**: HTML5, CSS3 (Grid, Modern CSS), Vanilla JavaScript.
*   **Editor**: CKEditor 5 (подключен через CDN).
*   **Deployment**: Render.com.

## Структура проекта
Проект спроектирован так, чтобы быть минималистичным, с плоской структурой, объединяющей похожий функционал.

```text
/bod-flask-learn
├── app.py                 # Основной файл приложения (настройка, запуск)
├── crud.py                # Все операции с базой данных (Supabase) и хранилищем
├── routes_admin.py        # Маршруты админ-панели (/bod/*)
├── routes_public.py       # Публичные маршруты (просмотр уроков)
├── config.py              # Конфигурация (переменные окружения)
├── requirements.txt       # Зависимости Python
├── runtime.txt            # Версия Python для Render
├── .env                   # Локальные переменные окружения (не в git)
├── .gitignore             # Игнорируемые файлы
├── init_db.sql            # (Существующий) Скрипт создания таблиц
├── seed_db.sql            # (Существующий) Скрипт заполнения данными
├── static/
│   ├── css/
│   │   └── style.css      # Основные стили (Grid, адаптивность, темы)
│   └── js/
│       ├── admin.js       # Логика админки (CKEditor, загрузка картинок)
│       └── main.js        # Общие скрипты (если понадобятся)
└── templates/
    ├── base.html          # Базовый шаблон (head, body, navigation)
    ├── error.html         # Страница 404/500
    ├── section_list.html  # Главная: список разделов и уроков
    ├── section.html       # Страница раздела
    ├── lesson.html        # Страница урока
    └── admin/
        ├── login.html     # Вход в админку
        ├── dashboard.html # Список уроков (CRUD кнопки)
        └── editor.html    # Редактор урока (CKEditor)
```

## Описание модулей

### 1. `config.py`
Загружает переменные окружения (`SUPABASE_URL`, `SUPABASE_KEY`, `ADMIN_LOGIN`, `ADMIN_PASSWORD` и др.). Централизованное место для настроек.

### 2. `crud.py`
Содержит функции для взаимодействия с Supabase через `supabase-py`.
*   Инициализация клиента Supabase.
*   Функции: `get_sections()`, `get_lesson(id)`, `create_lesson(data)`, `update_lesson(id, data)`, `delete_lesson(id)`, `upload_image(file)`.
*   Логика загрузки и получения публичных URL изображений.

### 3. `routes_public.py`
Обрабатывает запросы пользователей.
*   `/` -> redirect to sections list (или рендер списка).
*   `/section-<id>-<slug>/` -> просмотр раздела.
*   `/section-<id>-<slug>/lesson-<id>-<slug>` -> просмотр урока.
*   Генерация "хлебных крошек" и навигации.

### 4. `routes_admin.py`
Маршруты для управления контентом. Защищены проверкой сессии (простая проверка cookie/session).
*   `/bod` -> Вход.
*   `/bod/dashboard` -> Список разделов/уроков с кнопками управления.
*   `/bod/create`, `/bod/edit/<id>` -> Страница редактора.
*   API endpoints для сохранения данных и загрузки изображений (используются JS на фронтенде).

### 5. `templates/`
Использование Jinja2 и наследования от `base.html`.
*   Динамическая генерация меню и контента.
*   Минимальный HTML, упор на семантику.

### 6. `static/css/style.css`
*   Использование CSS Grid для макета.
*   Переменные CSS для темизации (светлая/темная тема).
*   Медиа-запросы для адаптивности (360px - 1920px+).

## База данных (Supabase)
Используется существующая схема (`sections`, `lessons`).
Связь `lessons.content` (JSONB) используется для хранения всей структуры урока (теория, тесты, HTML задач).

## Авторизация
*   Хардкод логин/пароль в `.env`.
*   При входе создается сессия (Flask Session) + `permanent = True` (30 дней при галочке).

## Процесс создания (Roadmap)
1.  **Настройка окружения**: Virtualenv, requirements.txt, .env.
2.  **Базовое приложение**: Flask app, config.
3.  **Слой данных**: Реализация `crud.py` и проверка связи с Supabase.
4.  **Админка**: Вход, Дашборд, интеграция CKEditor, сохранение в БД.
5.  **Публичная часть**: Отображение списка, страница урока, логика тестов (на JS).
6.  **Дизайн**: Верстка CSS, адаптивность, темы.
7.  **Деплой**: Подготовка файлов для Render.

Прошу утвердить данную структуру и описание.
